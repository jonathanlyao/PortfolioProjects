import pandas as pd
import numpy as np

# Start coding here...
# Read in csv
marketing = pd.read_csv("bank_marketing.csv")

# Split into 3 different tables
client = marketing[["client_id", "age", "job", "marital", "education", "credit_default", "mortgage"]]

campaign = marketing[["client_id", "number_contacts", "month", "day", "contact_duration", "previous_campaign_contacts","previous_outcome", "campaign_outcome"]]

economics = marketing[["client_id", "cons_price_idx", "euribor_three_months"]]

# Change "." to "_" for "job" column in client dataframe
client["job"] = client["job"].str.replace(".", "_")

# Change "." to "_" and "unknown" to np.NaN for "education" column in client dataframe
client["education"] = client["education"].str.replace(".", "_")
client["education"] = client["education"].replace("unknown", np.NaN)

# Convert to boolean data type: 1 if "yes", otherwise 0 for "credit_default" and "mortgage" columns in client dataframe
for col in ["credit_default", "mortgage"]: 
    client[col] = client[col].map({"yes":1, 
                                   "no":0, 
                                   "unknown":0})
    client[col] = client[col].astype(bool)
  
# Convert to boolean data type: 1 if "yes", otherwise 0 for "campaign_outcome" columns in campaign dataframe
for col in ["campaign_outcome"]: 
    campaign[col] = campaign[col].map({"yes":1, 
                                   "no":0, 
                                   "unknown":0})
    campaign[col] = campaign[col].astype(bool)
    
# Convert to boolean data type: 1 if "success", otherwise 0.
for col in ["previous_outcome"]: 
    campaign[col] = campaign[col].map({"success":1, 
                                   "failure":0, 
                                   "nonexistence":0
                                  })
    campaign[col] = campaign[col].astype(bool)
    
# For last_contact_date in campaign dataframe, create from a combination of day, month, and a newly created year column (which should have a value of 2022); Format = "YYYY-MM-DD" 
# Add a newly year column for the value of '2022'
campaign["year"] = "2022"

#Convert day to string
campaign["day"] = campaign["day"].astype(str)

# Combine day, month and year columns to last_contact_date
campaign["last_contact_date"] = campaign["year"] + "-" + campaign["month"] + "-" + campaign["day"]

# Convert the combined column to datetime format 
campaign["last_contact_date"] = pd.to_datetime(campaign["last_contact_date"], format = "%Y-%b-%d")

# Drop unnecessary columns of Year, Month and Day 
campaign["last_contact_date"] = campaign["last_contact_date"].drop(columns=["year", "month", "day"], inplace=True)

# Save 3 tables into 3 individual .csv files
client.to_csv("client.csv", index=False)
campaign.to_csv("campaign.csv", index=False)
economics.to_csv("economics.csv", index=False)

